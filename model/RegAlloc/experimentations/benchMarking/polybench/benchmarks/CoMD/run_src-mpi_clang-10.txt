cd /home/shalini/LOF_test/benchmarks/CoMD/src-mpi
rm *.ll
rm *.o
rm *.out

./generate_info_header CoMD-serial mpicc -lm 

clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g cmdLineParser.c  
clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g decomposition.c  
clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g haloExchange.c  
clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g linkCells.c  
clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g mycommand.c  
clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g performanceTimers.c  
clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g timestep.c
clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g CoMD.c           
clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g eam.c            
clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g initAtoms.c     
clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g ljForce.c    
clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g parallel.c   
clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g random.c             
clang-10 -emit-llvm -S -Xclang -disable-O0-optnone -O3 -g yamlOutput.c

llfiles=""
for file in *.ll; do llfiles+=$file" "; done
llvm-link-10 $llfiles -o final_src-mpi.ll
llc-10 final_src-mpi.ll -filetype=obj -o final_src-mpi.o
clang-10 final_src-mpi.o -lm -o final_src-mpi.out

for i in {0,1,2}
do
	time ./final_src-mpi.out
done

